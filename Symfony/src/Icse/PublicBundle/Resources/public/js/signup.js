(function(e){e.fn.shuffleChildren=function(){this.each(function(){e(this).children().sort(function(){return Math.random()-.5}).detach().appendTo(this)});return this};e(document).ready(function(){var r=300;var n=e("form#join_us").hasClass("freshersfair");var i=e("section").clone();var a;var o;function l(r){if(o===null){e(".show_if_email, .show_if_username, .show_if_player, #username_or_email_error").slideUp(r)}else if(o==="email"){e(".show_if_email").slideDown(r)}else if(o==="username"){e(".show_if_username").slideDown(r)}else if(o==="error"){e("#username_or_email_error").slideDown()}if(a!==null){e("#username_or_email_lookup").slideDown(r)}if(o==="email"||o==="username"){if(a){e(".show_if_player").slideDown(r)}else{e(".show_if_player").slideUp(r)}}}function s(r){if(o===null){var n=e("#username_or_email_lookup");var i=n.find("input");var a=n.find(".loading_spinner");i.prop("disabled",true);a.show();var s=e("#username_or_email_field").val();e.ajax({dataType:"json",url:Routing.generate("IcsePublicBundle_query_username"),data:{input:s}}).done(function(n){if(n["type"]=="email"){o="email";e("#form_email").val(s);e("#form_login").val("");e("#form_department").val("")}else if(n["type"]=="username"){o="username";e("#form_first_name").val(n["first_name"]);e("#form_last_name").val(n["last_name"]);e("#form_email").val(n["email"]);e("#form_login").val(s);e("#form_department").val(n["department"])}else{o="error"}e(".error_list").remove();l(r)}).always(function(){i.prop("disabled",false);a.hide()})}}function t(){s(r)}function u(){var r=e('input[name="form[instrument][]"]');if(a){if(r.is(":checked")){r.prop("required",false)}else{r.prop("required",true)}}else{r.prop("required",false)}}function f(r){if(e('#form_player input[value="1"]').is(":checked")){a=true;e("#form_standard").prop("required",true);m()}else if(e('#form_player input[value="0"]').is(":checked")){a=false;e("#form_standard").prop("required",false);e("#form_other_instrument").prop("required",false)}else{a=null}u();l(r)}function m(){if(e('#form_instrument input[value="other"]').is(":checked")){e("#form_other_instrument").prop("disabled",false);e("#form_other_instrument").prop("required",true)}else{e("#form_other_instrument").prop("disabled",true);e("#form_other_instrument").prop("required",false)}}function d(){var r=e("input#submit");var a=e(".loading_spinner.final_submit");r.prop("disabled",true);a.show();var o=new FormData(this);e.ajax({type:e(this).attr("method"),url:e(this).attr("action"),data:o,dataType:"html",cache:false,contentType:false,processData:false}).always(function(){r.prop("disabled",false);a.hide()}).done(function(r){e("section").replaceWith(e(r).find("section"));c();if(n&&e("form").length==0){setTimeout(function(){e("section").replaceWith(i.clone());c()},3e3)}});return false}function _(e){if(e.keyCode<13||e.keyCode==32||e.keyCode>40){o=null;l(r)}else if(e.keyCode==13){t()}}function p(){o=null;l(r)}function c(){a=null;o=null;e(".never_show").hide();l(0);m();f(0);if(e("#username_or_email_field").val()!=""){o=e("#form_login").val()!=""?"username":"email";l(0)}e("#username_or_email_lookup #lookup_button").click(t);e("#username_or_email_field").keyup(_);e("#username_or_email_field").bind("paste",p);e("#form_instrument").change(u);e("#form_instrument").change(m);e("#form_player").change(r,f);e("form").submit(d);h()}var h=function(){};if(n){(function(){var r=null;var n=e("html");var i=e("#slideshow.freshersfair");var o=i.find("#plugin_container");var l=o.find("#slides").detach();function s(){if(a===null){r=null;n.addClass("no-yscrollbar");i.show();var e=l.clone();e.find(".slides-container").shuffleChildren();o.append(e);e.superslides({play:4e3,animation:"fade",pagination:false})}}h=function(){o.empty();i.hide();n.removeClass("no-yscrollbar");if(r!==null)clearTimeout(r);r=setTimeout(s,5e3)};e(document).on("mousemove click touchstart",h)})()}c()})})(jQuery);